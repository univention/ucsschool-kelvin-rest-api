<h1>Changelog</h1>

<h2>v1.5.4 (2022-04-27)</h2>
<ul>
    <li>
         Enable log rotation of the Open Policy Agent (Bug #54247).
    </li>
    <li>
         The valid date range is now specified (Bug #54668).
    </li>
    <li>
         A new App Setting was added to configure the amount CPU cores utilized by the UCS@school Kelvin REST API (Bug #54575).
    </li>
    <li>
         It is now possible to define multiple schools for users via PATCH and PUT requests (Bug #54481, Bug #54690).
    </li>
</ul>

<h2>v1.5.3 (2022-02-08)</h2>
<ul>
    <li>
         Fixed token requests with authorized user and wrong password leading to <code>HTTP 500</code> (Bug #54431).
    </li>
    <li>
         The user get route now uses the correct filter when searching for UDM mapped properties (Bug #54474).
    </li>
</ul>

<h2>v1.5.2 (2022-01-07)</h2>
<ul>
    <li>
         The Kelvin API can now be installed on servers with the role DC Primary and DC Backup (Bug #54310).
    </li>
</ul>

<h2>v1.5.1 (2021-11-30)</h2>
<ul>
    <li>
         The Open Policy Agent component was added to components documentation (Bug #53960).
    </li>
    <li>
         The log output of the Open Policy Agent is now written to <code>/var/log/univention/ucsschool-kelvin-rest-api/opa.log</code> (Bug #53961).
    </li>
    <li>
        The test suite for the ``ucsschool.lib`` component was improved (Bug #53962).
    </li>
    <li>
        Username generation counter can now be raised above 100 (Bug #53987).
    </li>
    <li>
        The <code>no_proxy</code> environment variable is now honored by the Kelvin REST API when accessing the UDM REST API (Bug #54066).
    </li>
    <li>
        The user resource now has an <code>expiration_date</code> attribute, which can be used to set the account expiration date. A user won't be able to login from that date on (Bug #54126).
    </li>
</ul>

<h2>v1.5.0 (2021-09-10)</h2>
<ul>
    <li>
         Unixhomes are now set correctly for users. (Bug #52926)
    </li>
    <li>
         The Kelvin API now supports udm properties on all Kelvin resources except roles. (Bug #53744)
         Be advised that a new restriction was added that also applies to the udm_properties in the users resource and
         slightly alters the possible udm properties that can be configured. Please consult the manual section
         <a href="https://docs.software-univention.de/ucsschool-kelvin-rest-api/installation-configuration.html#udm-properties">UDM Properties</a>
         for details.
    </li>
</ul>
<h2>v1.4.4 (2021-06-29)</h2>
<ul>
    <li>
         The Kelvin API now supports UDM REST APIs using certificates, which are not signed by the UCS-CA. (Bug #52766)
    </li>
     <li>
         The UCS@school object validation now validate groups, schools and roles case-insensitive. (Bug #53044)
    </li>
</ul>
<h2>v1.4.3 (2021-06-16)</h2>
<ul>
    <li>
        A security error was fixed, that allowed the unrestricted use of the Kelvin API with unsigned authentication tokens.
        Please update as fast as possible (Bug #53454)!
    </li>
</ul>
<h2>v1.4.2 (2021-05-26)</h2>
<ul>
    <li>
       Support for hooks for objects managed by classes from the package ``ucsschool.lib.models`` was added. See manual section <a href="https://docs.software-univention.de/ucsschool-kelvin-rest-api/installation-configuration.html#python-hooks-for-pre-and-post-object-modification-actions">Python hooks for pre- and post-object-modification actions</a> for details (Bug #49557).
    </li>
    <li>
        An error when creating usernames with templates was fixed (Bug #52925).
    </li>
</ul>
<h2>v1.4.1 (2021-05-03)</h2>
<ul>
    <li>
       No error message is logged anymore after the deletion of an object (Bug #52896).
    </li>
    <li>
        Repeated restarts of the Kelvin server have been fixed.
    </li>
</ul>
<h2>v1.4.0 (2021-04-20)</h2>
<ul>
    <li>
       The FastAPI framework has been updated to version <code>0.63.0</code>.
    </li>
    <li>
       Open Policy Agent was added for access control and implemented partially for the user resource.
    </li>
    <li>
        The Kelvin API now supports creating schools (<a href="https://docs.software-univention.de/ucsschool-kelvin-rest-api/resource-schools.html#create">manual</a>).
    </li>
</ul>
<h2>v1.3.0 (2021-02-18)</h2>
<ul>
    <li>
       <p>It is now possible to change the roles of users. See manual section <a href="https://docs.software-univention.de/ucsschool-kelvin-rest-api/resource-users.html#changing-a-users-roles">Changing a users roles</a> for details.</p>
       <p>This feature depends on changes in the UDM REST API and thus the app requires <a href="https://errata.software-univention.de/#/?erratum=4.4x892">UCS 4.4-7 errata892</a> on the host system.</p>
    </li>
    <li>
        Validation errors when reading malformed user objects from LDAP now produce more helpful error messages.
    </li>
    <li>
        Internal improvement: A fallback for retrieving LDAP connection settings from UCR has been added for the case that that the environment variables are not available.
    </li>
    <li>
        UCS@school user and group objects are now validated before usage, when loading them from LDAP. See manual sections <a href="https://docs.software-univention.de/ucsschool-kelvin-rest-api/resources.html#resources">Resources</a> and <a href="https://docs.software-univention.de/ucsschool-kelvin-rest-api/installation-configuration.html#backup-count-of-validation-logging">Backup count of validation logging</a> for details.
    </li>
</ul>
<h2>v1.2.0 (2020-11-12)</h2>
<ul>
    <li>
        The attribute <code>kelvin_password_hashes</code> has been added to the user resource. It allows overwriting the password hashes in the UCS LDAP with the ones delivered. Use only if you know what you're doing!
    </li>
    <li>
        The user resource search speed has been improved: all matching users are now found with one LDAP lookup.
    </li>
    <li>
        Internal improvement: A fallback for retrieving LDAP connection settings from UCR has been added for the case that that the environment variables are not available.
    </li>
</ul>
<h2>v1.1.2 (2020-08-05)</h2>
<ul>
    <li>
        The following UCR variables are now copied into the Kelvin App Container via the joinscript:
        ucsschool/import/set/netlogon/script/path
        ucsschool/import/set/homedrive
        ucsschool/import/set/sambahome
        ucsschool/singlemaster
        ucsschool/import/set/serverprofile/path
        To sync the variables after they are changed on the host system the joinscript 50ucsschool-kelvin-rest-api
        has to be executed manually.
    </li>
</ul>
<h2>v1.1.1 (2020-06-15)</h2>
<ul>
    <li>
        The validation of the "name" attribute of the "SchoolClass" resource has been fixed to allow short class names like "1".
    </li>
    <li>
		The "password" attribute of the "User" resource has been fixed.
    </li>
    <li>
		The signatures of the "UserPyHook" methods have been adapted to be able to "await" async methods.
    </li>
    <li>
        The UCS CA is now added to the ``certifi`` SSL certification store.
    </li>
    <li>
        Support for the ``school_admin`` role was added.
    </li>
</ul>
<h2>v1.1.0 (2020-04-15)</h2>
<ul>
    <li>
        The UDM REST API Python Client library has been updated to version "0.4.0", so it can handle authorized access to the UDM REST API OpenAPI schema.
    </li>
</ul>
<h2>v1.0.1 (2020-02-17)</h2>
<ul>
    <li>The ucsschool lib has been extended to allow for context types other than "school" in "ucsschool_roles" attribute of most resources.
    </li>
</ul>
<h2>v1.0.0 (2020-01-20)</h2>
<ul>
    <li>Initial release.
    </li>
</ul>
